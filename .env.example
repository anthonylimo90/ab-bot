# AB-Bot / Polymarket Scanner Configuration
# Copy this file to .env and fill in your values

# ===================
# Environment
# ===================
# Options: development | staging | production
ENVIRONMENT=development

# ===================
# Docker Configuration
# ===================
POSTGRES_USER=abbot
POSTGRES_PASSWORD=abbot_secret
POSTGRES_DB=ab_bot
POSTGRES_PORT=5432

# Redis is not exposed to host by default in docker-compose (network-isolated).
# If you need host access for debugging, use: docker compose exec redis redis-cli ...
REDIS_PORT=6379
REDIS_APP_PASSWORD=app_secret_change_me
REDIS_DYNAMIC_TUNER_PASSWORD=dynamic_tuner_secret_change_me
REDIS_DYNAMIC_SUBSCRIBER_PASSWORD=dynamic_subscriber_secret_change_me

# ===================
# Database (Required)
# ===================
# For Docker: postgres://abbot:abbot_secret@postgres:5432/ab_bot
# For local: postgres://user:password@localhost:5432/ab_bot
DATABASE_URL=postgres://abbot:abbot_secret@localhost:5432/ab_bot
DATABASE_MAX_CONNECTIONS=20

# ===================
# Redis (Required)
# ===================
# For Docker (ACL app user): redis://app:<password>@redis:6379
# For local (ACL app user): redis://app:<password>@127.0.0.1:6379
REDIS_URL=redis://app:app_secret_change_me@127.0.0.1:6379
# Dynamic tuner publish/read connection (sole writer for dynamic:config:update)
DYNAMIC_TUNER_REDIS_URL=redis://dynamic_tuner:dynamic_tuner_secret_change_me@127.0.0.1:6379
# Dynamic config subscriber connection (read-only pub/sub consumer)
DYNAMIC_CONFIG_REDIS_URL=redis://dynamic_subscriber:dynamic_subscriber_secret_change_me@127.0.0.1:6379

# ===================
# Polygon RPC (Required - choose one)
# ===================
# Option 1: Alchemy (recommended)
ALCHEMY_API_KEY=your_alchemy_api_key_here

# Option 2: Direct RPC URL
# POLYGON_RPC_URL=https://polygon-mainnet.g.alchemy.com/v2/your_key

# ===================
# Polymarket API (Optional - uses defaults)
# ===================
# POLYMARKET_CLOB_URL=https://clob.polymarket.com
# POLYMARKET_WS_URL=wss://ws-subscriptions-clob.polymarket.com/ws/market

# ===================
# Alerts (Optional)
# ===================
# Telegram
# TELEGRAM_BOT_TOKEN=your_bot_token
# TELEGRAM_CHAT_ID=your_chat_id

# Discord
# DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...

# ===================
# API Server
# ===================
API_HOST=0.0.0.0
API_PORT=3000

# JWT_SECRET is REQUIRED and must be:
# - At least 32 characters long
# - A secure random value (not the default)
# Generate with: openssl rand -base64 32
JWT_SECRET=your-secure-random-secret-at-least-32-chars

CORS_PERMISSIVE=true
WS_CHANNEL_CAPACITY=1000

# ===================
# Arb Monitor
# ===================
POLLING_INTERVAL_MS=1000
MIN_ARB_PROFIT=0.01
MAX_POSITION_SIZE=1000
# Arb execution toggles
ARB_AUTO_EXECUTE=false
ARB_POSITION_SIZE=50
ARB_MIN_NET_PROFIT=0.001
ARB_MIN_BOOK_DEPTH=100
ARB_MAX_SIGNAL_AGE_SECS=30
ARB_CACHE_REFRESH_SECS=300
ARB_MIN_PROFIT_THRESHOLD=0.005
ARB_MONITOR_MAX_MARKETS=300
CLOB_MARKET_LIMIT=200000             # Market cache pagination limit
# stable | balanced | discovery
ARB_MONITOR_AGGRESSIVENESS=balanced
ARB_MONITOR_EXPLORATION_SLOTS=5
ARB_UPDATE_TIMEOUT_SECS=120

# ===================
# Copy Trading
# ===================
COPY_TRADING_ENABLED=false
COPY_TOTAL_CAPITAL=10000
COPY_MIN_TRADE_VALUE=0.50
COPY_MAX_SLIPPAGE_PCT=0.05
COPY_MAX_LATENCY_SECS=120
COPY_NEAR_RESOLUTION_MARGIN=0.03   # 3% floor enforced by backend (range: 0.03â€“0.25)
COPY_DAILY_CAPITAL_LIMIT=5000
COPY_MAX_OPEN_POSITIONS=15
COPY_STOP_LOSS_ENABLED=true
COPY_STOP_LOSS_CHECK_SECS=30
COPY_STOP_LOSS_PCT=0.15
COPY_TAKE_PROFIT_PCT=0.25
COPY_MAX_HOLD_HOURS=72
COPY_MIRROR_EXITS=true
TRADE_MONITOR_MAX_AGE_SECS=120
TRADE_MONITOR_WALLET_LIMIT=100
AUTO_ROTATION_INTERVAL_SECS=900    # Auto-optimizer cycle interval (seconds)

# ===================
# Live Trading
# ===================
LIVE_TRADING=false
EXECUTOR_MIN_BOOK_DEPTH=100
# WALLET_PRIVATE_KEY=0x...

# ===================
# Dynamic Tuner
# ===================
DYNAMIC_TUNER_ENABLED=true
DYNAMIC_TUNER_APPLY=true
DYNAMIC_TUNER_INTERVAL_SECS=300
DYNAMIC_TUNER_REGIME_STREAK=2
DYNAMIC_TUNER_FREEZE_DRAWDOWN=0.20
DYNAMIC_TUNER_EVAL_DELAY_MINUTES=10
DYNAMIC_TUNER_FILL_DEGRADE_DELTA=0.08
DYNAMIC_TUNER_PNL_DEGRADE_DELTA=75
DYNAMIC_TUNER_BOOTSTRAP_ENABLED=true
DYNAMIC_TUNER_BOOTSTRAP_MAX_ATTEMPTS=100
DYNAMIC_TUNER_NO_TRADE_WINDOW_MINUTES=120
DYNAMIC_TUNER_NO_TRADE_MIN_ATTEMPTS=20
DYNAMIC_CONFIG_ALLOWED_SOURCES=dynamic_tuner,dynamic_tuner_rollback,dynamic_tuner_sync,workspace_manual

# ===================
# Monitoring (Optional)
# ===================
PROMETHEUS_PORT=9090
GRAFANA_PORT=3001
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# ===================
# Email (Optional - for password reset)
# ===================
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USERNAME=your-username
# SMTP_PASSWORD=your-password
# SMTP_FROM=noreply@yourdomain.com
# SMTP_FROM_NAME=Polymarket Scanner
# APP_URL=https://your-dashboard-url.com

# ===================
# Logging
# ===================
RUST_LOG=api_server=info,arb_monitor=info,bot_scanner=info,polymarket_core=info
